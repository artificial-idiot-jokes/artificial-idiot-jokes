<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Artificial Idiot â€” Joke & Riddle Bot</title>
  <link rel="icon" href="favicon.svg">
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <main class="wrap">
    <h1>ðŸ¤– Artificial Idiot</h1>
    <p class="sub">Playful web experiments â€¢ <strong>Joke &amp; Riddle Bot</strong></p>

    <section class="card">
      <div class="tabs">
        <label class="tab"><input type="radio" name="mode" value="riddle" checked /> Riddles</label>
        <label class="tab"><input type="radio" name="mode" value="anti-joke" /> Anti-jokes</label>
      </div>
      <div class="row">
        <input id="topic" placeholder="Give me a topic (optional)â€¦" />
        <button id="go">Generate</button>
      </div>
      <pre id="out" class="out"> </pre>
      <p class="tip">Tip: set <code>OPENAI_API_KEY</code> as a Netlify environment variable and re-deploy.</p>
    </section>

    <footer>Â© Artificial Idiot â€” client UI + serverless brain</footer>
  </main>

  <script>
    const out = document.getElementById('out');
    const topic = document.getElementById('topic');
    const go = document.getElementById('go');
    function mode() {
      return document.querySelector('input[name="mode"]:checked').value;
    }
    async function generate() {
      out.textContent = 'Thinkingâ€¦';
      try {
        const res = await fetch('/.netlify/functions/jokebot', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ type: mode(), topic: topic.value || '' })
        });
        if (!res.ok) {
          out.textContent = 'Error: HTTP ' + res.status + ':' + '\n' + (await res.text());
          return;
        }
        const data = await res.json();
        out.textContent = data.text || JSON.stringify(data, null, 2);
      } catch (err) {
        out.textContent = 'Error: ' + err.message;
      }
    }
    go.addEventListener('click', generate);
  </script>
</body>
</html>
