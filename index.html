<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ðŸ¤– Artificial Idiot â€” Jokes & Riddles</title>
  <link rel="icon" href="favicon.svg">
  <link rel="stylesheet" href="style.css">
  <style>
    body { max-width: 780px; margin: 2rem auto; padding: 0 1rem; font: 16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, sans-serif; color:#e9eef3; background:#0c1117; }
    .card { background:#111827; border:1px solid #233244; border-radius:12px; padding:1rem 1.25rem; }
    .row { display:flex; gap:1rem; align-items:center; flex-wrap:wrap; }
    textarea { width:100%; min-height:180px; border-radius:10px; padding:12px; border:1px solid #2a3b52; background:#0e1621; color:#e9eef3; }
    button { border:0; padding:.75rem 1.1rem; border-radius:10px; background:#2276ff; color:white; font-weight:600; cursor:pointer; }
    button:disabled { opacity:.6; cursor:progress; }
    .muted { color:#9db0c0; font-size:.9rem; }
    .tabs label { margin-right: 1rem; cursor:pointer; }
    input[type="radio"] { transform: translateY(1px); }
  </style>
</head>
<body>
  <h1>ðŸ¤– Artificial Idiot</h1>
  <p class="muted">Playful web experiments â€¢ <strong>Joke &amp; Riddle Bot</strong> (via OpenRouter)</p>

  <div class="card">
    <div class="tabs row" role="tablist" aria-label="Mode">
      <label><input type="radio" name="mode" value="riddle" checked> Riddles</label>
      <label><input type="radio" name="mode" value="anti"> Anti-jokes</label>
    </div>

    <div style="height:.6rem"></div>

    <div class="row">
      <input id="topic" placeholder="Give me a topic (optional)â€¦" style="flex:1; min-width:220px; padding:.65rem .8rem; border-radius:10px; border:1px solid #2a3b52; background:#0e1621; color:#e9eef3;">
      <button id="go">Generate</button>
    </div>

    <div style="height:1rem"></div>

    <textarea id="out" readonly placeholder="Your comedy gold will appear hereâ€¦"></textarea>

    <p class="muted">Tip: this is using <code>OPENROUTER_API_KEY</code> from Netlify env and the free model
      <code>meta-llama/llama-3.1-8b-instruct:free</code>.</p>
  </div>

  <script>
    const btn = document.getElementById('go');
    const out = document.getElementById('out');
    const topic = document.getElementById('topic');

    function modeValue() {
      const el = document.querySelector('input[name="mode"]:checked');
      return el ? el.value : "riddle";
    }

    btn.addEventListener('click', async () => {
      btn.disabled = true;
      out.value = "Thinking up something wittyâ€¦";
      try {
        const res = await fetch('/.netlify/functions/jokebot', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            mode: modeValue() === 'anti' ? 'anti' : 'riddle',
            topic: topic.value.trim()
          })
        });
        const data = await res.json();
        out.value = data.text || data.error || "Hmm, nothing came back.";
      } catch (e) {
        out.value = "Client error: " + e;
      } finally {
        btn.disabled = false;
      }
    });
  </script>
</body>
</html>
