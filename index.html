<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Artificial Idiot â€” Joke & Riddle Bot (OpenRouter)</title>
  <link rel="icon" href="favicon.svg" />
  <link rel="stylesheet" href="style.css" />
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 24px; color: #e6edf3; background:#0d1117; }
    .card { max-width: 760px; margin: 0 auto; padding: 20px; background:#161b22; border:1px solid #30363d; border-radius:12px; }
    h1 { margin: 0 0 12px; font-size: 28px; }
    .row { display:flex; gap:14px; align-items:center; flex-wrap:wrap; }
    .chip { display:inline-flex; gap:8px; align-items:center; padding:8px 12px; border-radius:999px; background:#0b6; color:#071; }
    .tabs { display:flex; gap:16px; margin:18px 0 12px; }
    .tab input { appearance:none; width:16px; height:16px; border:2px solid #58a6ff; border-radius:50%; display:inline-block; vertical-align:middle; margin-right:8px; position:relative; }
    .tab input:checked { background:#58a6ff; }
    input[type="text"] { flex:1; min-width:240px; padding:10px 12px; border-radius:8px; border:1px solid #30363d; background:#0d1117; color:#e6edf3; }
    button { padding:10px 14px; border-radius:8px; border:0; background:#238636; color:#fff; cursor:pointer; }
    button:disabled { opacity:.6; cursor:default; }
    pre { white-space:pre-wrap; word-wrap:break-word; padding:14px; background:#0d1117; border:1px dashed #30363d; border-radius:8px; min-height:140px; }
    .tip { color:#8b949e; font-size:14px; }
    .err { color:#ffb4b4; }
  </style>
</head>
<body>
  <div class="card">
    <h1>ðŸ¤– Artificial Idiot</h1>
    <div class="tip">Playful web experiments â€¢ <b>Joke &amp; Riddle Bot</b> (via OpenRouter)</div>
    <div class="tabs">
      <label class="tab">
        <input type="radio" name="mode" value="riddle" checked>
        Riddles
      </label>
      <label class="tab">
        <input type="radio" name="mode" value="anti">
        Anti-jokes
      </label>
    </div>
    <div class="row">
      <input id="topic" type="text" placeholder="Give me a topic (optional)..." />
      <button id="go">Generate</button>
    </div>
    <pre id="out"></pre>
    <div class="tip">The API call is proxied by a Netlify Function (your key stays safe in the server).</div>
  </div>
  <script>
    const $ = (s)=>document.querySelector(s);
    const out = $('#out');
    const go = $('#go');
    async function run() {
      try {
        go.disabled = true;
        out.textContent = 'Thinking up something questionably funnyâ€¦';
        const mode = document.querySelector('input[name="mode"]:checked').value;
        const topic = $('#topic').value.trim();
        const res = await fetch('/.netlify/functions/joke', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ mode, topic })
        });
        if (!res.ok) {
          const text = await res.text();
          throw new Error(`HTTP ${res.status}: ${text}`);
        }
        const data = await res.json();
        out.textContent = data.text || '(no response)';
      } catch (err) {
        out.innerHTML = 'Error:\n' + (err?.message || err);
        out.classList.add('err');
      } finally {
        go.disabled = false;
      }
    }
    go.addEventListener('click', run);
    document.addEventListener('keydown', (e)=> (e.key === 'Enter') && run());
  </script>
</body>
</html>